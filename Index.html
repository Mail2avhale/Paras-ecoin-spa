<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PARAS ECOIN</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #f5f3ff;
      color: #4c1d95;
    }
    .container {
      max-width: 600px;
      margin: 2rem auto;
      background: white;
      border-radius: 16px;
      padding: 1.5rem;
      box-shadow: 0 0 16px #ddd;
    }
    button {
      padding: 10px 20px;
      margin: 8px 0;
      background: #6d28d9;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    button:hover {
      background: #7c3aed;
    }
    .vip {
      background: gold;
      color: black;
      padding: 4px 8px;
      border-radius: 8px;
      display: inline-block;
      margin-top: 4px;
    }
    .market-item {
      border: 1px solid #ddd;
      padding: 10px;
      margin: 6px 0;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container" id="app">
    <h2>🚀 Welcome to PARAS ECOIN</h2>
    <div id="userSection">
      <button onclick="signIn()">Sign in with Google</button>
    </div>

    <div id="dashboard" style="display:none;">
      <p>👤 <span id="userName"></span> <span id="vipBadge" class="vip" style="display:none;">VIP</span></p>
      <p>💰 Balance: <span id="balance">0</span> PEC</p>
      <p>🎁 Daily Bonus: <button onclick="claimBonus()">Claim</button></p>
      <p>👆 Tap Tycoon: <button onclick="playGame()">+ Tap</button> | Score: <span id="score">0</span></p>
      <p>🕊️ Charity Redeem: <button onclick="redeem()">Redeem 100 PEC</button></p>

      <h3>🛍️ Marketplace</h3>
      <div class="market-item">Mobile Recharge – 1000 PEC</div>
      <div class="market-item">Shopping Voucher – 5000 PEC</div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js"></script>

  <script>
    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyBVzkXwX5Fhwq-NiCWbC9ii8cq-5jPY3ac",
      authDomain: "paras-ecoin-bfad2.firebaseapp.com",
      projectId: "paras-ecoin-bfad2",
      storageBucket: "paras-ecoin-bfad2.appspot.com",
      messagingSenderId: "315406512180",
      appId: "1:315406512180:web:a6330984e75cca65bc1a61"
    };
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    let currentUser = null;

    function signIn() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then(result => {
          currentUser = result.user;
          document.getElementById("userName").innerText = currentUser.displayName;
          loadUserData();
          document.getElementById("userSection").style.display = "none";
          document.getElementById("dashboard").style.display = "block";
        });
    }

    async function loadUserData() {
      const userRef = db.collection("users").doc(currentUser.uid);
      const doc = await userRef.get();
      if (!doc.exists) {
        await userRef.set({
          balance: 0,
          isVIP: false,
          gameScore: 0,
          lastLogin: new Date(),
          totalCharity: 0,
          wallet: ""
        });
      }
      const data = (await userRef.get()).data();
      document.getElementById("balance").innerText = data.balance;
      document.getElementById("score").innerText = data.gameScore;
      if (data.isVIP) document.getElementById("vipBadge").style.display = "inline-block";
    }

    async function claimBonus() {
      const userRef = db.collection("users").doc(currentUser.uid);
      const doc = await userRef.get();
      const data = doc.data();
      const now = new Date();
      const lastLogin = data.lastLogin?.toDate();

      if (!lastLogin || now - lastLogin > 86400000) {
        await userRef.update({
          balance: data.balance + 100,
          lastLogin: now
        });
        alert("🎁 Bonus Claimed!");
        loadUserData();
      } else {
        alert("⏳ Bonus already claimed today.");
      }
    }

    async function playGame() {
      const userRef = db.collection("users").doc(currentUser.uid);
      const doc = await userRef.get();
      const score = doc.data().gameScore || 0;
      await userRef.update({ gameScore: score + 1, balance: doc.data().balance + 1 });
      loadUserData();
    }

    async function redeem() {
      const userRef = db.collection("users").doc(currentUser.uid);
      const doc = await userRef.get();
      let bal = doc.data().balance;
      if (bal < 100) {
        alert("Not enough balance.");
        return;
      }
      await userRef.update({
        balance: bal - 100,
        totalCharity: (doc.data().totalCharity || 0) + 10
      });
      alert("💸 100 PEC Redeemed (10 to Charity)");
      loadUserData();
    }
  </script>
</body>
</html>
